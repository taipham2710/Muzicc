title = "MUZICC Gitleaks Configuration"

# =========================
# GLOBAL ALLOWLIST
# =========================
[allowlist]
paths = [
  '''.*schemas.*''',
  '''.*dto.*''',
  '''.*types.*''',
  '''.*\.test\..*''',
  '''.*\.spec\..*''',
  '''frontend/.*'''
]

regexes = [
  '''password\s*:\s*(str|string)''',
  '''token\s*:\s*(str|string)'''
]

# =========================
# AWS KEYS
# =========================
[[rules]]
id = "aws-access-key"
description = "AWS Access Key ID"
regex = '''AKIA[0-9A-Z]{16}'''
entropy = 3.5
tags = ["aws", "secret"]

[[rules]]
id = "aws-secret-key"
description = "AWS Secret Access Key"
regex = '''(?i)aws(.{0,20})?(secret|access).{0,20}?[=:]["']?[A-Za-z0-9/+=]{40}'''
entropy = 3.5
tags = ["aws", "secret"]

# =========================
# JWT SECRET (VALUE-BASED)
# =========================
[[rules]]
id = "jwt-secret"
description = "Hardcoded JWT secret value"
regex = '''(?i)(jwt|secret)_?(key|secret)?\s*=\s*["'][^"']{20,}["']'''
entropy = 3.5
tags = ["jwt", "secret"]

# =========================
# GENERIC PASSWORD VALUE
# =========================
[[rules]]
id = "hardcoded-password"
description = "Hardcoded password value"
regex = '''(?i)(password|passwd|pwd)\s*=\s*["'][^"']{8,}["']'''
entropy = 3.5
tags = ["password", "secret"]
