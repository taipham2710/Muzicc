title = "MUZICC Production Gitleaks Configuration"

[allowlist]
paths = [
  '''.*schemas.*''',
  '''.*dto.*''',
  '''.*types.*''',
  '''.*\.test\..*''',
  '''.*\.spec\..*'''
]

[[rules]]
id = "aws-access-key"
description = "AWS Access Key ID"
regex = '''AKIA[0-9A-Z]{16}'''
entropy = 4.0
tags = ["aws", "secret"]

[[rules]]
id = "aws-secret-key"
description = "AWS Secret Access Key"
regex = '''(?i)aws(.{0,20})?(secret|access).{0,20}?[=:]["']?[A-Za-z0-9/+=]{40}'''
entropy = 4.5
tags = ["aws", "secret"]

[[rules]]
id = "jwt-secret"
description = "Hardcoded JWT secret value"
regex = '''(?i)(jwt|secret)_?(key|secret)?\s*[:=]\s*["'][^"']{16,}["']'''
entropy = 4.0
tags = ["jwt", "secret"]

[[rules]]
id = "hardcoded-password"
description = "Hardcoded password value"
regex = '''(?i)(password|passwd|pwd)\s*[:=]\s*["'][^"']{8,}["']'''
entropy = 4.0
tags = ["password", "secret"]

[[rules]]
id = "database-url"
description = "Hardcoded database URL"
regex = '''postgres(ql)?://[^:]+:[^@]+@[^:]+:[0-9]+/[^\s"']+'''
tags = ["database", "secret"]

[[rules]]
id = "slack-webhook"
description = "Slack webhook URL"
regex = '''https://hooks\.slack\.com/services/[A-Za-z0-9/_-]+'''
tags = ["slack", "secret"]

[[rules]]
id = "generic-bearer-token"
description = "Generic Bearer token"
regex = '''Bearer\s+[A-Za-z0-9\-_\.]{20,}'''
entropy = 4.0
tags = ["token", "secret"]
